ğŸ‘ SuperComplexå¤æ‚ä½“ç³»çš„åˆ†å­åŠ¨åŠ›å­¦æ¨¡æ‹Ÿ

---
[TOC]

---
## æ¡ˆä¾‹ä¸€
å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå«æœ‰79æ¡è›‹ç™½é“¾ï¼Œå†…è´¨ç½‘è†œï¼Œä»¥åŠå¤šç§é…ä½“å°åˆ†å­ä»¥åŠæ— æœºå°åˆ†å­çš„å»ºæ¨¡ä»¥åŠMDã€‚  
![](SuperComplexå¤æ‚ä½“ç³»çš„åˆ†å­åŠ¨åŠ›å­¦æ¨¡æ‹Ÿ/SuperComplexå¤æ‚ä½“ç³»çš„åˆ†å­åŠ¨åŠ›å­¦æ¨¡æ‹Ÿ_2023-05-11-21-07-14.png)  

**ï¼ˆ1ï¼‰é¦–å…ˆæ‹¿åˆ°å†·å†»ç”µé•œç»“æ„ç¬¬ä¸€æ­¥è¦åšçš„å°±æ˜¯å¯¹è›‹ç™½è¿›è¡Œé“¾é‡å‘½åï¼Œæ–¹ä¾¿è¿›è¡Œåç»­çš„å¯è§†åŒ–ã€‚**  
å»ºè®®åˆ†é“¾æŒ‰ç…§segment:chainè¿›è¡Œåˆ†ï¼ŒsegnameæŒ‰ç…§PRAï¼ŒPRBï¼ŒPRCâ€¦â€¦è¿›è¡Œç¼–æ’ï¼ŒchainæŒ‰ç…§26ä¸ªå¤§å†™å­—æ¯è¿›è¡Œç¼–æ’ã€‚å¯ä½¿ç”¨ä¸‹è¿°è„šæœ¬ï¼š  
```python
def rename_chain_number(pdb):
    
    new_chain = [" A", " B", " C", " D", " E", " F", " G", " H", " I", " J", " K", " L", " M", " N", " O", " P", " Q", " R", " S", " T", " U", " V", " W", " X", " Y", " Z"]
    seg = ["PRA", "PRB", "PRC", "PRD", "PRE", "PRF", "PRG", "PRH", "PRI", "PRJ"]

    with open(pdb) as f:
        f1 = f.readlines()

    old_chains = list()
    for i in f1:
        if i.startswith("ATOM") or i.startswith("HETATM"):
            old_chains.append(i[20:22])
    # old_chains = list(old_chains)
    # old_chains.reverse()
    old_chains = sorted(set(old_chains), key=old_chains.index)
    print("old_chains: ", old_chains)

    cycles = len(old_chains)//len(new_chain)
    others = len(old_chains)%len(new_chain)
    new_seg_chains = []
    for i in range(cycles):
        for j in new_chain:
            new_seg_chains.append(seg[i]+j)
    for i in new_chain[:others]:
        new_seg_chains.append(seg[cycles]+i)

    print("new_seg_chains: ", new_seg_chains)

    dic_old_new = dict(zip(old_chains, new_seg_chains))

    rt = open(pdb.strip(".pdb")+"_rechain.pdb", "w")
    # idx = 1
    # for i in f1:
    #     if i.startswith("ATOM") or i.startswith("HETATM"):
    #         if idx <= 99999:
    #             rt.write(i[0:6]+'{:5d}'.format(idx)+i[11:20]+dic_old_new[i[20:22]][-2:]+i[22:72]+dic_old_new[i[20:22]][:3]+i[75:])
    #         else:
    #             rt.write(i[0:6]+'{:5d}'.format(99999)+i[11:20]+dic_old_new[i[20:22]][-2:]+i[22:72]+dic_old_new[i[20:22]][:3]+i[75:])
    #     else:
    #         rt.write(i)

    for i in f1:
        if i.startswith("ATOM") or i.startswith("HETATM"):
            rt.write(i[0:20]+dic_old_new[i[20:22]][-2:]+i[22:72]+dic_old_new[i[20:22]][:3]+i[75:])
        else:
            rt.write(i)
```

**ï¼ˆ2ï¼‰å°†é…ä½“å°åˆ†å­ä»¥åŠæ— æœºå°åˆ†å­ç­‰å…¨éƒ¨å•ç‹¬æå–ä¿å­˜å¹¶ç”Ÿæˆç»“æ„å’ŒåŠ›åœºã€‚**  
æœ‰æœºå°åˆ†å­å»ºè®®æ¯ç§å°åˆ†å­å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé¦–å…ˆä½¿ç”¨CHARMMGUIæŸ¥çœ‹æ¯ç§å°åˆ†å­æ˜¯å¦å®Œæ•´å­˜åœ¨äºåŠ›åœºæ–‡ä»¶ä¸­ï¼Œè‹¥å­˜åœ¨äºåŠ›åœºæ–‡ä»¶ä¸­éœ€è¦å°†é…ä½“ï¼ˆå¯èƒ½å¤šä¸ªé…ä½“ç»„æˆçš„ä¸€ä¸ªpdbæ–‡ä»¶ï¼‰å»æ°¢ï¼Œç„¶ååŸå­åç§°ä¸åŠ›åœºæ‹“æ‰‘çš„åç§°å¯¹åº”ä¸Šç„¶åä½¿ç”¨pdb2gmxç”Ÿæˆitpä»¥åŠåŠ æ°¢åçš„pdbæ–‡ä»¶ï¼ˆå…¶å®æœ‰ä¸¤ç§åšæ³•ï¼Œç¬¬ä¸€ç§æ˜¯å°†å¤šä¸ªé…ä½“æ”¾åœ¨ä¸€ä¸ªpdbæ–‡ä»¶ä¸­ä½¿ç”¨pdb2gmxç”Ÿæˆitpï¼Œç„¶åæ€»topolä¸­çš„[ molecules ]ä¸­æ•°é‡å†™ä¸€ä¸ªå°±è¡Œï¼›ç¬¬äºŒç§å°±æ˜¯å°†ä¸€ä¸ªé…ä½“æ”¾åœ¨pdbæ–‡ä»¶ä¸­ç”Ÿæˆitpï¼Œç„¶åæ€»topolä¸­çš„[ molecules ]ä¸­å†™æ¸…æ•°é‡å°±è¡Œï¼Œæ¨èç¬¬ä¸€ç§ï¼‰ã€‚   
å¯¹äºæ²¡æœ‰åŠ›åœºçš„å°åˆ†å­ï¼Œå¯¹äºåŒç§åˆ†å­å¤šä¸ªçš„å»ºè®®å¯¹æ¯ä¸€ä¸ªåˆ†å­éƒ½ä¸Šä¼ åˆ°cgenffä¸­äº§ç”ŸåŠ›åœºå‚æ•°ä»¥åŠæ‹“æ‰‘ï¼Œä¸ç„¶å°†åŸå­åç§°ä¸topolæ–‡ä»¶å¯¹åº”èµ·æ¥å¤ªéº»çƒ¦ï¼Œè¿˜å®¹æ˜“å‡ºé”™ã€‚   
æ— æœºå°åˆ†å­å¦‚æœcgenffæ— æ³•äº§ç”Ÿtopolçš„è¯å»ºè®®ä½¿ç”¨"äº§ç”ŸåŠ›åœºå‚æ•°ä»¥åŠGromacsæ‹“æ‰‘æ–‡ä»¶çš„å·¥å…·-Sobtop"è¿›è¡Œæ–°å®šä¹‰åŸå­ç±»å‹å¹¶ç”Ÿæˆprmï¼Œitpã€‚  

**ï¼ˆ3ï¼‰å»ºç«‹è›‹ç™½çš„topolã€‚**  
ä¸ªäººå€¾å‘çš„åšæ³•æ˜¯ï¼šå°†è›‹ç™½åˆ†æˆä¸€æ¡ä¸€æ¡é“¾ï¼ˆåŒ…å«é‡‘å±ç¦»å­ï¼Œæœ‰çš„æ—¶å€™éœ€è¦ä¿®æ”¹é‡‘å±ç¦»å­çš„åç§°ï¼‰ï¼Œç„¶ååˆ†åˆ«å¯¹æ¯æ¡é“¾ä½¿ç”¨pdb2gmxï¼ˆå»ºè®®ä½¿ç”¨-merge all å°†æ‰€æœ‰éƒ½å†™åˆ°ä¸€ä¸ªtopol.topæ–‡ä»¶ä¸­ï¼‰ç”Ÿæˆæ¯æ¡é“¾çš„topol.topä»¥åŠpdbæ–‡ä»¶ã€‚å°†topolåˆ é™¤é¦–å°¾ç”Ÿæˆitpæ–‡ä»¶ï¼Œå¹¶ä¸”ä¿®æ”¹æ¯ä¸ªitpçš„åç§°ã€‚å°†pdbæ–‡ä»¶ä¸­æ‚è¡Œå…¨éƒ¨åˆ é™¤ï¼Œåªä¿ç•™åæ ‡è¡Œã€‚    

**ï¼ˆ4ï¼‰å»ºç«‹æ€»topolã€‚**   
ç¤ºä¾‹å¦‚ä¸‹æ–‡ä»¶æ‰€ç¤ºï¼š[topol.top](./SuperComplexå¤æ‚ä½“ç³»çš„åˆ†å­åŠ¨åŠ›å­¦æ¨¡æ‹Ÿ/topol.top)

**ï¼ˆ5ï¼‰å°†è›‹ç™½æ’å…¥åˆ°è†œä¸­ã€‚**   
å¯èƒ½éœ€è¦åœ¨å¯¹pdbçš„é“¾è¿›è¡Œå‘½åï¼Œç„¶ååˆå¹¶æ‰€æœ‰pdbã€‚ä½¿ç”¨pymolå°†è›‹ç™½æ‹–å…¥è†œä¸­å¹¶è°ƒæ•´è›‹ç™½çš„ä½ç½®ã€‚åˆ é™¤è›‹ç™½å‘¨å›´0.8åŸƒèŒƒå›´å†…çš„å·¦å³è„‚åˆ†å­ã€‚ä¿å­˜è›‹ç™½ä»¥åŠè†œçš„åæ ‡ï¼ˆåˆ‡è®°åœ¨pymolä¸­ä¿å­˜å‹¾é€‰ä¸‹é¢é€‰é¡¹ï¼Œä¿å­˜åŸå­çš„é¡ºåºï¼‰ã€‚    
![](SuperComplexå¤æ‚ä½“ç³»çš„åˆ†å­åŠ¨åŠ›å­¦æ¨¡æ‹Ÿ/SuperComplexå¤æ‚ä½“ç³»çš„åˆ†å­åŠ¨åŠ›å­¦æ¨¡æ‹Ÿ_2023-05-11-21-36-58.png)     
å°†è›‹ç™½ä»¥åŠè†œçš„pdbåˆå¹¶å¹¶è½¬æˆgroæ–‡ä»¶ï¼Œå¹¶ä¿®æ”¹topol.topæ–‡ä»¶ä¸­è„‚åˆ†å­çš„æ•°é‡è¿›è¡Œä¿®æ”¹ï¼ˆå› ä¸ºåˆ é™¤äº†ä¸€éƒ¨åˆ†è„‚åˆ†å­ï¼‰ã€‚   
ç”Ÿæˆç›’å­ï¼ŒåŠ æ°´ï¼ŒåŠ ç¦»å­ï¼Œåˆ é™¤è†œä¸­çš„æ°´åˆ†å­å’Œç¦»å­å¹¶ä¿®æ”¹å¯¹åº”çš„topol.topæ–‡ä»¶ã€‚   

**ï¼ˆ6ï¼‰è¿›è¡Œæ¨¡æ‹Ÿ**  
å»ºè®®ï¼šå¯æŒ‰ç…§CHARMMGUIä¸Šçš„mdpæ–‡ä»¶é€æ­¥å¯¹è„‚åˆ†å­è¿›è¡Œé™åˆ¶ä¸æ”¾å¼€ï¼Œå¦å¤–ï¼Œå¯¹äºè›‹ç™½å’Œæ°´ï¼Œè›‹ç™½å‰ä¸¤æ­¥é™åˆ¶é‡åŸå­ï¼Œåé¢æ”¾å¼€ã€‚æ°´ä¸€ç›´é™åˆ¶Zè½´ã€‚å¦å¤–åœ¨å…¨éƒ¨æ”¾å¼€åå†åŠ ä¸€ä¸ªnptæ–‡ä»¶ï¼Œç”¨äºå°†æ°´å®Œå…¨æ”¾å¼€å¹¶è°ƒæ•´ç›’å­å¤§å°ã€‚æœ€åå®Œå…¨æ”¾å¼€è¿›è¡ŒMDå³å¯ã€‚   