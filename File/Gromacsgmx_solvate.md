👏 Gromacs|gmx solvate

---
[TOC]

---
## 简介
体系溶剂化。

## 格式
```text
gmx solvate [-cp [<.gro/.g96/..>]] [-cs [<.gro/.g96/…>]]
    [-o [<.gro/.g96/…>]] [-p [<.top>]] [-nice ]
    [-box ] [-radius ] [-scale ] [-shell ]
    [-maxsol ] [-[no]vel]
```

## 参数
**输入/输出文件选项**
|参数|默认值|类型|说明|
|:----|:----|:----|:----|
|-cp [<.gro/.g96/...>]|protein.gro|输入，可选|结构文件：gro g96 pdb brk ent esp tpr tpb tpa|
|-cs [<.gro/.g96/...>]|spc216.gro|输入，库|结构文件：gro g96 pdb brk ent esp tpr tpb tpa|
|-o [<.gro/.g96/...>]|out.gro|输出|结构文件：gro g96 pdb brk ent esp|
|-p [<.top>]|topol.top|输入/输出，可选|拓扑文件。|

**控制选项**
|参数|默认值|说明|
|:----|:----|:----|
|-nice \<int>|19|设置优先级。|
|-box \<vector>|0 0 0|盒子尺寸(单位nm)。|
|-radius \<real>|0.105|默认的范德华距离。|
|-scale \<real>|0.57|用于数据文件share/gromacs/top/vdwradii.dat中范德华半径的缩放因子。
对水中的蛋白质，使用默认值0.57可以得到接近1000 g/l的密度值。|
|-shell \<real>|0|溶质周围水层的可选厚度。|
|-maxsol \<int>|0|加入的最大溶剂分子数。若为零(默认)则忽略此选项。|
|-[no]vel|no|保持溶质和溶剂分子输入文件中的速度。|

## 常规使用方法
（1）**创建一个充满溶剂的盒子。可以通过指定-cs和-box选项来完成。** 对具有盒子信息但不含原子的结构文件则可以通过指定-cs和-cp来实现。

（2）将溶质分子，如蛋白质进行溶剂化，使其处于溶剂分子的包围之中。**-cp和-cs分别用于指定溶质和溶剂。** 不设定-box时会使用溶质坐标文件(-cp)中的盒子信息。**如果你希望将溶质置于盒子的中心，可以使用gmx editconf命令，它有非常多的选项用于改变盒子的规格和使分子居中。** 对某一位置，若溶质分子中任意原子与溶剂分子中任意原子之间的距离小于这两个原子的范德华半径之和，则会将溶剂分子从盒子中移除。程序会读取数据文件(vdwradii.dat)中的范德华半径，并根据-scale选项的设置进行缩放。若不能在数据文件中找到所需的半径值，相应的原子将通过-radius来设定(未缩放)距离。

（3）**默认使用的溶剂是简单点电荷水模型(SPC, Simple Point Charge Water)，坐标文件为$GMXLIB/spc216.gro。** 这些坐标同样可以用于其他的三点水模型，因为通过短时间的平衡就可以去除这些模型之间的差异。程序也支持其余的溶剂分子和混合溶剂。对溶剂类型的唯一限制是一个溶剂分子只包含一种残基。程序会使用坐标文件中的残基信息，因此这些信息应保持一定程度的一致性。实际使用中这就意味着坐标文件中两个连续的溶剂分子应该具有不同的残基编号。溶质盒子是根据坐标文件中的坐标进行堆积构建而成，这意味着这些坐标应该在周期性边界条件下进行平衡，以确保分子在堆积界面上具有良好的排列。**-maxsol选项可以设置加入的最大溶剂分子数，程序只添加前-maxsol个溶剂分子而忽略其余的。** 这样在盒子中形成了一部分真空，这在后面可能会引起一些问题。请明智地选择最大分子数和盒子体积。

（4）**该程序还可以旋转溶质分子，使其最长的分子轴与盒子边缘对齐。** 这样可以减少所需要的溶剂分子。值得注意的是这只适用于短时间的模拟，如500 ps内溶液中的α-螺旋多肽可以旋转90度。因此通常来说选用接近立方体的盒子会好一些。

（5）**-shell的设定值大于零时，将会在溶质周围放置指定厚度(nm)的水层。** 提示：最好先将蛋白质分子置于盒子中央(使用gmx editconf)。

（6）gmx solvate命令还可以去除拓扑文件中说明已添加的溶剂分子数的行，并在坐标文件中添加包含溶剂分子总数的新行。

（7）**gmx solvate可以为模拟分子添加溶剂环境。**
* -cp：带盒子参数的分子坐标文件，一般是editconf的输出文件。
* -cs：添加的水分子模型，如spc216，spce，tip3p，tip4p等。
* -o：输出坐标文件，就是添加水分子之后的分子坐标文件，默认为.gro文件，但也可以为其他格式，如pdb。
* -p：体系拓扑文件，gmx solvate会往里面写入添加水分子的个数。这个不要忘记，不然在进行下一步计算时，会出现坐标文件和拓扑文件中原子数不一致的错误。

## 源码位置及解析
gromacs-2022.2/src/gromacs/gmxpreprocess/solvate.cpp

## 示例
